{
  "id": "d2f5d97b-495e-4c7a-ad94-495c864c33a9",
  "prevId": "00000000-0000-0000-0000-000000000000",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.abuse_signals": {
      "name": "abuse_signals",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "reporter_edge_id": {
          "name": "reporter_edge_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "conversation_id": {
          "name": "conversation_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "message_id": {
          "name": "message_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "reason": {
          "name": "reason",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "abuse_signals_conv_idx": {
          "name": "abuse_signals_conv_idx",
          "columns": [
            {
              "expression": "conversation_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "abuse_signals_created_idx": {
          "name": "abuse_signals_created_idx",
          "columns": [
            {
              "expression": "created_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "abuse_signals_reporter_edge_id_edges_id_fk": {
          "name": "abuse_signals_reporter_edge_id_edges_id_fk",
          "tableFrom": "abuse_signals",
          "tableTo": "edges",
          "columnsFrom": [
            "reporter_edge_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "abuse_signals_conversation_id_conversations_id_fk": {
          "name": "abuse_signals_conversation_id_conversations_id_fk",
          "tableFrom": "abuse_signals",
          "tableTo": "conversations",
          "columnsFrom": [
            "conversation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "abuse_signals_message_id_messages_id_fk": {
          "name": "abuse_signals_message_id_messages_id_fk",
          "tableFrom": "abuse_signals",
          "tableTo": "messages",
          "columnsFrom": [
            "message_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.auth_nonces": {
      "name": "auth_nonces",
      "schema": "",
      "columns": {
        "nonce": {
          "name": "nonce",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "identity_id": {
          "name": "identity_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "auth_nonces_identity_id_identities_id_fk": {
          "name": "auth_nonces_identity_id_identities_id_fk",
          "tableFrom": "auth_nonces",
          "tableTo": "identities",
          "columnsFrom": [
            "identity_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.bridge_messages": {
      "name": "bridge_messages",
      "schema": "",
      "columns": {
        "message_id": {
          "name": "message_id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "bridge_type": {
          "name": "bridge_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "sender_external_id": {
          "name": "sender_external_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "sender_display_name": {
          "name": "sender_display_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "platform_message_id": {
          "name": "platform_message_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "bridge_messages_bridge_type_idx": {
          "name": "bridge_messages_bridge_type_idx",
          "columns": [
            {
              "expression": "bridge_type",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "bridge_messages_sender_idx": {
          "name": "bridge_messages_sender_idx",
          "columns": [
            {
              "expression": "sender_external_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "bridge_messages_message_id_messages_id_fk": {
          "name": "bridge_messages_message_id_messages_id_fk",
          "tableFrom": "bridge_messages",
          "tableTo": "messages",
          "columnsFrom": [
            "message_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.bridge_status_events": {
      "name": "bridge_status_events",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "edge_id": {
          "name": "edge_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "previous_status": {
          "name": "previous_status",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "connection_duration_ms": {
          "name": "connection_duration_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "reconnect_attempt": {
          "name": "reconnect_attempt",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "bridge_status_events_edge_id_idx": {
          "name": "bridge_status_events_edge_id_idx",
          "columns": [
            {
              "expression": "edge_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "bridge_status_events_timestamp_idx": {
          "name": "bridge_status_events_timestamp_idx",
          "columns": [
            {
              "expression": "timestamp",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "bridge_status_events_status_idx": {
          "name": "bridge_status_events_status_idx",
          "columns": [
            {
              "expression": "status",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "bridge_status_events_edge_timestamp_idx": {
          "name": "bridge_status_events_edge_timestamp_idx",
          "columns": [
            {
              "expression": "edge_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "timestamp",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "bridge_status_events_edge_id_edges_id_fk": {
          "name": "bridge_status_events_edge_id_edges_id_fk",
          "tableFrom": "bridge_status_events",
          "tableTo": "edges",
          "columnsFrom": [
            "edge_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.conversation_participants": {
      "name": "conversation_participants",
      "schema": "",
      "columns": {
        "conversation_id": {
          "name": "conversation_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "edge_id": {
          "name": "edge_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "external_id": {
          "name": "external_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "display_name": {
          "name": "display_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_owner": {
          "name": "is_owner",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "joined_at": {
          "name": "joined_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "conv_participants_conv_idx": {
          "name": "conv_participants_conv_idx",
          "columns": [
            {
              "expression": "conversation_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "conv_participants_edge_idx": {
          "name": "conv_participants_edge_idx",
          "columns": [
            {
              "expression": "edge_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "conv_participants_external_idx": {
          "name": "conv_participants_external_idx",
          "columns": [
            {
              "expression": "external_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "conversation_participants_conversation_id_conversations_id_fk": {
          "name": "conversation_participants_conversation_id_conversations_id_fk",
          "tableFrom": "conversation_participants",
          "tableTo": "conversations",
          "columnsFrom": [
            "conversation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "conversation_participants_edge_id_edges_id_fk": {
          "name": "conversation_participants_edge_id_edges_id_fk",
          "tableFrom": "conversation_participants",
          "tableTo": "edges",
          "columnsFrom": [
            "edge_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.conversations": {
      "name": "conversations",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "origin": {
          "name": "origin",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "edge_id": {
          "name": "edge_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "security_level": {
          "name": "security_level",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "encrypted_metadata": {
          "name": "encrypted_metadata",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "bridge_metadata": {
          "name": "bridge_metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "ratchet_state": {
          "name": "ratchet_state",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "last_activity_at": {
          "name": "last_activity_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "conversations_edge_idx": {
          "name": "conversations_edge_idx",
          "columns": [
            {
              "expression": "edge_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "conversations_origin_idx": {
          "name": "conversations_origin_idx",
          "columns": [
            {
              "expression": "origin",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "conversations_edge_id_edges_id_fk": {
          "name": "conversations_edge_id_edges_id_fk",
          "tableFrom": "conversations",
          "tableTo": "edges",
          "columnsFrom": [
            "edge_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.edges": {
      "name": "edges",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "owner_query_key": {
          "name": "owner_query_key",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "bridge_type": {
          "name": "bridge_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'email'"
        },
        "is_native": {
          "name": "is_native",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "address": {
          "name": "address",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "label": {
          "name": "label",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'active'"
        },
        "security_level": {
          "name": "security_level",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "x25519_public_key": {
          "name": "x25519_public_key",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "disabled_at": {
          "name": "disabled_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "rotated_from_edge_id": {
          "name": "rotated_from_edge_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "policy": {
          "name": "policy",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "message_count": {
          "name": "message_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "last_activity_at": {
          "name": "last_activity_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "edges_owner_query_key_idx": {
          "name": "edges_owner_query_key_idx",
          "columns": [
            {
              "expression": "owner_query_key",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "edges_type_address_idx": {
          "name": "edges_type_address_idx",
          "columns": [
            {
              "expression": "type",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "address",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "edges_type_idx": {
          "name": "edges_type_idx",
          "columns": [
            {
              "expression": "type",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "edges_bridge_type_idx": {
          "name": "edges_bridge_type_idx",
          "columns": [
            {
              "expression": "bridge_type",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "edges_is_native_idx": {
          "name": "edges_is_native_idx",
          "columns": [
            {
              "expression": "is_native",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.files": {
      "name": "files",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "conversation_id": {
          "name": "conversation_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "message_id": {
          "name": "message_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "uploader_edge_id": {
          "name": "uploader_edge_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "uploader_query_key": {
          "name": "uploader_query_key",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "encrypted_filename": {
          "name": "encrypted_filename",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "mime_type": {
          "name": "mime_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'application/octet-stream'"
        },
        "size_bytes": {
          "name": "size_bytes",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "storage_key": {
          "name": "storage_key",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "storage_bucket": {
          "name": "storage_bucket",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'relay-files'"
        },
        "cdn_url": {
          "name": "cdn_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'active'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "deleted_at": {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "files_conversation_idx": {
          "name": "files_conversation_idx",
          "columns": [
            {
              "expression": "conversation_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "files_message_idx": {
          "name": "files_message_idx",
          "columns": [
            {
              "expression": "message_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "files_uploader_query_key_idx": {
          "name": "files_uploader_query_key_idx",
          "columns": [
            {
              "expression": "uploader_query_key",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "files_status_idx": {
          "name": "files_status_idx",
          "columns": [
            {
              "expression": "status",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "files_storage_key_idx": {
          "name": "files_storage_key_idx",
          "columns": [
            {
              "expression": "storage_key",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "files_conversation_id_conversations_id_fk": {
          "name": "files_conversation_id_conversations_id_fk",
          "tableFrom": "files",
          "tableTo": "conversations",
          "columnsFrom": [
            "conversation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "files_message_id_messages_id_fk": {
          "name": "files_message_id_messages_id_fk",
          "tableFrom": "files",
          "tableTo": "messages",
          "columnsFrom": [
            "message_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "files_uploader_edge_id_edges_id_fk": {
          "name": "files_uploader_edge_id_edges_id_fk",
          "tableFrom": "files",
          "tableTo": "edges",
          "columnsFrom": [
            "uploader_edge_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.identities": {
      "name": "identities",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "public_key": {
          "name": "public_key",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "home_server": {
          "name": "home_server",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'userelay.org'"
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'active'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "last_seen_at": {
          "name": "last_seen_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.messages": {
      "name": "messages",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "protocol_version": {
          "name": "protocol_version",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'1.0'"
        },
        "conversation_id": {
          "name": "conversation_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "edge_id": {
          "name": "edge_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "origin": {
          "name": "origin",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "security_level": {
          "name": "security_level",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'e2ee'"
        },
        "content_type": {
          "name": "content_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'text/plain'"
        },
        "sender_external_id": {
          "name": "sender_external_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "ciphertext": {
          "name": "ciphertext",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "ephemeral_pubkey": {
          "name": "ephemeral_pubkey",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "nonce": {
          "name": "nonce",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "ratchet_pn": {
          "name": "ratchet_pn",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "ratchet_n": {
          "name": "ratchet_n",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "encrypted_content": {
          "name": "encrypted_content",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "plaintext_content": {
          "name": "plaintext_content",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "signature": {
          "name": "signature",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "messages_conv_idx": {
          "name": "messages_conv_idx",
          "columns": [
            {
              "expression": "conversation_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "messages_created_idx": {
          "name": "messages_created_idx",
          "columns": [
            {
              "expression": "created_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "messages_conversation_id_conversations_id_fk": {
          "name": "messages_conversation_id_conversations_id_fk",
          "tableFrom": "messages",
          "tableTo": "conversations",
          "columnsFrom": [
            "conversation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "messages_edge_id_edges_id_fk": {
          "name": "messages_edge_id_edges_id_fk",
          "tableFrom": "messages",
          "tableTo": "edges",
          "columnsFrom": [
            "edge_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.rate_limit_ledger": {
      "name": "rate_limit_ledger",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "subject_id": {
          "name": "subject_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "action_type": {
          "name": "action_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "timestamp": {
          "name": "timestamp",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "rate_limit_subject_action_idx": {
          "name": "rate_limit_subject_action_idx",
          "columns": [
            {
              "expression": "subject_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "action_type",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "rate_limit_timestamp_idx": {
          "name": "rate_limit_timestamp_idx",
          "columns": [
            {
              "expression": "timestamp",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.redemption_codes": {
      "name": "redemption_codes",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "code": {
          "name": "code",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "asset_type": {
          "name": "asset_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "value": {
          "name": "value",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'active'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "redeemed_at": {
          "name": "redeemed_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "failed_attempts": {
          "name": "failed_attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        }
      },
      "indexes": {
        "redemption_codes_code_idx": {
          "name": "redemption_codes_code_idx",
          "columns": [
            {
              "expression": "code",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "redemption_codes_status_idx": {
          "name": "redemption_codes_status_idx",
          "columns": [
            {
              "expression": "status",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "redemption_codes_code_unique": {
          "name": "redemption_codes_code_unique",
          "nullsNotDistinct": false,
          "columns": [
            "code"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.redemption_receipts": {
      "name": "redemption_receipts",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "receipt_key": {
          "name": "receipt_key",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "code_id": {
          "name": "code_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "redeemed_at": {
          "name": "redeemed_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "redemption_receipts_receipt_key_idx": {
          "name": "redemption_receipts_receipt_key_idx",
          "columns": [
            {
              "expression": "receipt_key",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "redemption_receipts_code_id_idx": {
          "name": "redemption_receipts_code_id_idx",
          "columns": [
            {
              "expression": "code_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "redemption_receipts_code_id_redemption_codes_id_fk": {
          "name": "redemption_receipts_code_id_redemption_codes_id_fk",
          "tableFrom": "redemption_receipts",
          "tableTo": "redemption_codes",
          "columnsFrom": [
            "code_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "redemption_receipts_receipt_key_unique": {
          "name": "redemption_receipts_receipt_key_unique",
          "nullsNotDistinct": false,
          "columns": [
            "receipt_key"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.visitor_sessions": {
      "name": "visitor_sessions",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "contact_link_edge_id": {
          "name": "contact_link_edge_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "visitor_public_key": {
          "name": "visitor_public_key",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "display_name": {
          "name": "display_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "encrypted_ratchet_state": {
          "name": "encrypted_ratchet_state",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "encrypted_message_history": {
          "name": "encrypted_message_history",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "conversation_id": {
          "name": "conversation_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "failed_attempts": {
          "name": "failed_attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "last_attempt_at": {
          "name": "last_attempt_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "last_activity_at": {
          "name": "last_activity_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "visitor_sessions_contact_link_idx": {
          "name": "visitor_sessions_contact_link_idx",
          "columns": [
            {
              "expression": "contact_link_edge_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "visitor_sessions_visitor_key_idx": {
          "name": "visitor_sessions_visitor_key_idx",
          "columns": [
            {
              "expression": "contact_link_edge_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "visitor_public_key",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "visitor_sessions_conversation_idx": {
          "name": "visitor_sessions_conversation_idx",
          "columns": [
            {
              "expression": "conversation_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "visitor_sessions_contact_link_edge_id_edges_id_fk": {
          "name": "visitor_sessions_contact_link_edge_id_edges_id_fk",
          "tableFrom": "visitor_sessions",
          "tableTo": "edges",
          "columnsFrom": [
            "contact_link_edge_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "visitor_sessions_conversation_id_conversations_id_fk": {
          "name": "visitor_sessions_conversation_id_conversations_id_fk",
          "tableFrom": "visitor_sessions",
          "tableTo": "conversations",
          "columnsFrom": [
            "conversation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    }
  },
  "enums": {},
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {},
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}